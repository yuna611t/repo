<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>SVG</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
<style>
svg { width: 320px; height: 240px; border: 1px solid black; }
.line { fill: none; stroke: black; }
.axis text {
    font-family: sans-serif;
    font-size: 11px;
}
.axis path,
.axis line {
    fill: none;
    stroke: black;
}
.axis_x line {
    fill: none;
    stroke: black;
}
.itemA { stroke: #000; fill: }
.itemB { stroke: #666; fill: }
.itemC { stroke: #ccc; fill: }
</style>
    </head>
    <body>

<h1>折れ線グラフを表示</h1>
<svg id="myGraph"></svg>

<script type="text/javascript">
// SVG要素
var svgWidth = 320;
var svgHeight = 240;
// 軸
var offSetX = 30;
var offSetY = 20;
// グラフ情報
var scale = 2.0;
// データセット
var dataSet = [
    [
        { year: 2004, value: 10 },
        { year: 2005, value: 47 },
        { year: 2006, value: 65 },
        { year: 2007, value: 8 },
        { year: 2008, value: 64 }
    ],
    [
        { year: 2004, value: 90 },
        { year: 2005, value: 77 },
        { year: 2006, value: 55 },
        { year: 2007, value: 48 },
        { year: 2008, value: 64 }
    ],
    [
        { year: 2004, value: 50 },
        { year: 2005, value: 27 },
        { year: 2006, value: 45 },
        { year: 2007, value: 58 },
        { year: 2008, value: 84 }
    ]
];
var margin = svgWidth/(dataSet[0].length - 1);
// 各折れ線グラフを表示
drawGraph(dataSet[0], "itemA", "linear"); // 直線
drawGraph(dataSet[1], "itemB", "linear");
drawGraph(dataSet[2], "itemC", "linear");   
// 目盛りを表示
drawScale();

/**
 * 折れ線グラフを表示する
 * @param  {Array} dataSet       データセット
 * @param  {string} cssClassName 適用するCSSスタイル
 * @param  {string} type         折れ線グラフのタイプ
 */
function drawGraph (dataSet, cssClassName, type) {
    // 折れ線グラフの座標値を計算するメソッド
    var line = d3.svg.line()
        .x(function (d, i) {
            return i * margin + offSetX;
        })
        .y(function (d, i) {
            return svgHeight - (d.value * scale)  - offSetY;
        })
        .interpolate(type)
    // 折れ線グラフの描画
    var lineElements = d3.select("#myGraph")
        .append("path")
        .attr("class", "line " + cssClassName )
        .attr("d", line(dataSet))
}

/**
 * 目盛りを表示する
 */
function drawScale () {
    // 目盛りを表示するためにスケールを設定
    var yScale = d3.scale.linear()
        .domain([10, 100])
        .range([scale * 100, 0])
    // 目盛りを表示
    d3.select("#myGraph")
        .append("g")
        .attr("class", "axis")
        .attr("transform", "translate("+ offSetX + ", " + offSetY +")")
        .call(
            d3.svg.axis()
                .scale(yScale)
                .orient("left")
        )
    // 横方向の軸を表示
    d3.select("#myGraph")
        .append("rect")
        .attr("class", "axis_x")
        .attr("width", svgWidth)
        .attr("height", 1)
        .attr("transform", "translate("+ offSetX + ", " + (svgHeight - offSetY - 0.5) +")")
}



</script>
    </body>
</html>
